# test-group

Проект создан для отладки распределенного кеша groupcache

Как запускать:

Необходимо запустить два или более инстансов приложения с разными портами или хостами. 

У приложения 3 аргументы:

1. порт http для приема внешних запросов;
2. нода и порт для кеша groupcache;
3. список всех нод кеша groupcache (следует помнить, что текущая нода должна быть в списке первой).


Например, запуск первой ноды:
```bash
./test-group 3001 localhost:4001 http://localhost:4001,http://localhost:4002
```

Запуск второй ноды:
```bash
./test-group 3002 localhost:4002 http://localhost:4002,http://localhost:4001
```

## API

Доступно два эндпоинта:

GET /read

Для получения текущего значения кеша

GET /write

Для записи рандомного числа в кеш

## Тестирование

В составе приложения есть готовый сценарий тестирования, представлен в файле test.sh. В нем последовательно идет 
запись то на первой ноде, то на второй и запрашиваются значения с обеих нод, они должны совпасть, например:

Запуск
```bash 
./test.sh
```

Результат:
```json
write #1.1 (первая нода делает запись значения в первый раз) 
{"value": "931966010070867690"}{"value": "931966010070867690"}{"value": "931966010070867690"}

write #2.1 (вторая нода делает запись значения в первый раз)
{"value": "2394978132384883180"}{"value": "2394978132384883180"}{"value": "2394978132384883180"}

write #2.2 (вторая нода обновляет значение)
{"value": "2439290961429717979"}{"value": "2439290961429717979"}{"value": "2439290961429717979"}

write #1.2 (первая нода обновляет значение)
{"value": "3128146306534013380"}{"value": "3128146306534013380"}{"value": "3128146306534013380"}
```